@import "fonts"

// Font & layout variables (only works w/ mononoki)
// HACK(jordan): this ratio is bullshitted by trial-and-error
font-size = 16px
character-height-width-ratio = (11.25/20)
fluffywaffles-characters = 13

h1-font-size = font-size * 1.66
h2-font-size = font-size * 1.33
// NOTE(jordan): there is no h3. Don't ask about 4, 5, and 6.

li-bullet-space = body-character-width
li-spacing = 20px
li-line-height = 14px + li-spacing

h1-character-width = character-height-width-ratio * h1-font-size
body-character-width = character-height-width-ratio * font-size
body-text-color = #abb2bf
body-background-color = #282c34
header-background-color = lighten(body-background-color, 10%)
highlight-background-color = lighten(header-background-color, 10%)

content-max-width = body-character-width * 74
content-left-space = "calc(50% - (%s / 2))" % (content-max-width)
content-overlay-margin = 50px

index-content-max-width = body-character-width * 45
index-content-left-space = "calc(50% - (%s / 2))" % (
  index-content-max-width
)

// Logo variables
logo-width = 200px
logo-height = 150px
// HACK(jordan): these offsets are hard-coded
logo-drip-offset-x = 20px
logo-drip-offset-y = 40px
logo-height-with-drips = logo-height * 2 - logo-drip-offset-y

logo_waffle_yellow=#ffff00
logo_waffle_dip=#ffe600
logo_waffle_edge=#ffd200

*
  box-sizing border-box

html, body
  margin 0
  min-height 100%
  background body-background-color
  font-family mononoki, monospace
  color body-text-color
  font-size font-size

body
  overflow-y scroll

main > *:last-child
  padding-bottom 200px

section
  max-width content-max-width
  margin-left content-left-space

header
  background header-background-color
  h1
    padding-left content-left-space
    margin 0
    padding-top 5px
    padding-bottom 5px
    background #2c323c

nav
  padding 10px
  margin-left 0
  &[horizontal]
    padding 0
    max-width content-max-width
    margin-left content-left-space
  a
    text-decoration none
    color inherit

ul
  margin 0
  padding 0
  list-style-type none
  li
    margin 0
    padding 0
    line-height li-line-height
    &::before
      content ''
      position relative
      left -1 * li-bullet-space

dl
  dd
    margin-top 10px
    audio
      width 90%
  dd + dt
    margin-top 20px

h1
  font-size h1-font-size
h2
  font-size h2-font-size
h3
  font-size font-size

a
  text-decoration none
  color lighten(body-text-color, 10%)
  background-color highlight-background-color
  padding 0px 10px
  &:hover
    background-color lighten(highlight-background-color, 10%)
  &:active
    font-style italic

.panel
  padding 50px 20px
  background highlight-background-color

img.sink
  width calc(100% - 10px)
  border 20px solid highlight-background-color

header > h1.main-title
  position relative

  &:before
    content ''
    overflow hidden
    position absolute
    font-size @font-size
    top 0
    left 0
    width "calc(50% - (%s / 2) - 1.5 * %s)" % (
      content-max-width h1-character-width
    )
    height 100%
    background #50545a
    @media all and (max-width: content-max-width)
      width 40px - (1.5 * h1-character-width)

  &::after
    content ''
    width h1-character-width - 1px
    height 100%
    display block
    background white
    animation blink 0.8s infinite alternate
    position absolute
    top 0
    left "calc(50% - %s / 2 + (%s + 1.5) * %s)" % (
      content-max-width fluffywaffles-characters h1-character-width
    )
    @media all and (max-width: content-max-width)
      left 40px + (fluffywaffles-characters + 1.5) * h1-character-width

// NOTE(jordan): only supports sublists 1 level deep
ul.collapsible-tree
  &[horizontal]
    display flex
    flex-wrap wrap
    li
      white-space nowrap
      flex 0 1 50%
      min-width (body-character-width * 33)
      position relative
      text-overflow ellipsis
      a
        background-color transparent
        &:hover
          background-color transparent
        &:active
          font-style normal
      ul
        padding-left li-bullet-space * 2
        margin-left li-bullet-space
        max-width "calc(100% - %s)" % (li-bullet-space * 3)
        position absolute
        background highlight-background-color
        padding-right 20px
        // TODO(jordan): generalize
        &.z-3
          z-index 3
        &.z-2
          z-index 2
        &.z-1
          z-index 1
  ul
    overflow hidden
    height 0
    transition height ease 350ms
  li
    color body-text-color
    cursor pointer
    padding-left li-bullet-space
    &:hover
      color #fff
    &::before
      content '-'
    &.collapse-1, &.collapse-2, &.collapse-3
      &::before
        content '+'
      &.open::before
        content '-'
    &.collapse-0::before
      content '<'

  & > li.open
    & > ul > li::before, & > ul > a > li::before
      content '-'
    &.collapse-1 > ul
      height (li-line-height) * 1
    &.collapse-2 > ul
      height (li-line-height) * 2
    &.collapse-3 > ul
      height (li-line-height) * 3

.fluffywaffles-logo
  width logo-width
  height logo-height-with-drips
  position relative

  object.logo
    background url('./images/fluffywaffles-notext-lt.png')
    background-size contain
    background-repeat no-repeat
    position relative
    z-index 2
    height logo-height

  svg.drip-animation
    width 100%
    height logo-height
    position absolute
    z-index 1
    left logo-drip-offset-x
    top logo-height - logo-drip-offset-y

body.index
  header
    padding-top 50px
    .fluffywaffles-logo
      left "calc(50% - %s)" % (logo-width / 2)

  header > h1.main-title::before
    width "calc(50% - (%s / 2) - 1.5 * %s)" % (
      index-content-max-width h1-character-width
    )

  header > h1.main-title::after
    left "calc(50% - %s / 2 + (%s + 1.5) * %s)" % (
      index-content-max-width fluffywaffles-characters h1-character-width
    )

  header > h1
    padding-left index-content-left-space

  section
    max-width index-content-max-width

  section
    margin-left index-content-left-space

breakpoint = content-max-width + 40px
@media all and (max-width: breakpoint)
  header > h1
    padding-left 20px

  section, nav[horizontal]
    max-width calc(100% - 40px)
    margin-left 20px

@keyframes blink
  0%
    opacity 1.0
  40%
    opacity 1.0
  60%
    opacity 0.0
  100%
    opacity 0.0
